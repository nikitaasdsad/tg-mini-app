<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–ì–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è ‚Äî –º–∏–Ω–∏-–∞–ø–ø</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0f1113;
    --card:#121316;
    --muted:#bfc7cd;
    --accent:#2EA44F;
    --glass: rgba(255,255,255,0.03);
    --accent-2: #ff7ab6;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui, -apple-system, "Segoe UI", Roboto, Arial; background:var(--bg); color:#fff}
  .wrap{max-width:1100px;margin:14px auto;padding:12px}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px}
  h1{font-size:18px;margin:0;font-weight:700}
  .subtitle{color:var(--muted);font-size:13px}
  /* grid */
  .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  @media(min-width:900px){ .grid{grid-template-columns:repeat(4,1fr);} }
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));
    border-radius:12px; overflow:hidden; position:relative; box-shadow:0 8px 30px rgba(0,0,0,0.6);
    transform-origin:center; transition:transform .25s ease, box-shadow .25s ease;
    cursor:pointer;
  }
  .card:hover{ transform:translateY(-6px) scale(1.03); box-shadow:0 18px 40px rgba(0,0,0,0.7); }
  .thumb{width:100%; aspect-ratio:4/5; object-fit:cover; display:block; transition:transform .4s ease;}
  .card:hover .thumb{ transform:scale(1.06); }
  .overlay{
    position:absolute; left:0; right:0; bottom:0;
    background:linear-gradient(0deg, rgba(0,0,0,0.85), rgba(0,0,0,0.12));
    padding:12px; transform: translateY(100%); transition: transform .22s ease;
    display:flex; flex-direction:column; gap:6px;
  }
  .card:hover .overlay, .card.show-overlay .overlay{ transform: translateY(0%); }
  .title{font-weight:700;font-size:14px}
  .short{font-size:13px;color:var(--muted);line-height:1.2}
  .btn-row{display:flex;gap:8px;margin-top:8px}
  .btn{padding:8px 10px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff}
  .btn.primary{background:var(--accent);color:#06140a}
  /* detail */
  .detail{display:none}
  .detail.active{display:block}
  .detail .viewer{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 10px 30px rgba(0,0,0,0.6)}
  .viewer .imgwrap{width:100%;height:min(62vh,700px);background:#000;border-radius:10px;overflow:hidden;display:flex;align-items:center;justify-content:center}
  .viewer img{width:100%;height:100%;object-fit:cover;display:block}
  .nav{display:flex;gap:8px;justify-content:center;margin-top:10px}
  .pager{display:flex;gap:6px;justify-content:center;margin-top:8px}
  .dot{width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,0.12)}
  .dot.active{background:var(--accent)}
  .caption{color:var(--muted);margin-top:10px}
  .detail-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;gap:8px}
  /* code area */
  .codebox{margin-top:14px;padding:12px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)}
  .code{font-family:monospace;font-size:20px;letter-spacing:2px;padding:6px 10px;border-radius:6px;background:rgba(0,0,0,0.3);display:inline-block}
  .hint{color:var(--muted);font-size:13px;margin-top:8px}
  .small{font-size:13px;color:var(--muted)}
  /* playful accent */
  .accent-pill{background:linear-gradient(90deg,var(--accent),var(--accent-2));padding:6px 10px;border-radius:999px;color:#06140a;font-weight:700}
  /* mobile */
  @media(max-width:600px){
    .thumb{height:220px}
    .viewer .imgwrap{height:52vh}
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <h1>üìö –ì–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è</h1>
      <div class="subtitle">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω—É ‚Äî –æ—Ç–∫—Ä–æ–π—Ç–µ –µ—ë –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å¬ª, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –±–æ—Ç–∞.</div>
    </div>
    <div class="accent-pill">–ë—ã—Å—Ç—Ä–æ –∏ –ø—Ä–æ—Å—Ç–æ</div>
  </header>

  <!-- MAIN GALLERY -->
  <div id="mainView">
    <div class="grid" id="grid"></div>
  </div>

  <!-- DETAIL VIEW -->
  <div id="detailView" class="detail">
    <div class="detail-header">
      <div style="font-weight:700" id="detailTitle">Title</div>
      <div>
        <button id="detailBack" class="btn ghost">üîô –ù–∞–∑–∞–¥</button>
        <button id="rentBtn" class="btn primary">–ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å</button>
      </div>
    </div>

    <div class="viewer">
      <div class="imgwrap" id="imgWrap">
        <img id="detailImg" src="" alt="image"/>
      </div>

      <div class="nav" style="margin-top:12px">
        <button id="prevBtn" class="btn ghost">‚óÄÔ∏è</button>
        <button id="nextBtn" class="btn ghost">‚ñ∂Ô∏è</button>
      </div>

      <div class="pager" id="pager"></div>
      <div class="caption" id="detailCaption"></div>

      <!-- Code block (hidden until rent) -->
      <div id="codeArea" class="codebox" style="display:none">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
          <div>
            <div class="small">–í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ –±–æ—Ç–∞:</div>
            <div style="display:flex;align-items:center;gap:10px;margin-top:8px">
              <div id="theCode" class="code">GS00ABCD</div>
              <button id="copyBtn" class="btn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <div class="hint">–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –≤ —á–∞—Ç —Å –±–æ—Ç–æ–º ‚Äî –±–æ—Ç –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏—è (–≤—Ä–µ–º—è –∏ —à–∞–≥–∏ –≤—ã–±–µ—Ä–µ—Ç–µ –≤ –±–æ—Ç–µ).</div>
          </div>
          <div style="min-width:140px;text-align:right">
            <div class="small">–ú–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±—É—Ñ–µ—Ä–µ.</div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
/* ======= Data ======= */
const ALL_SCENARIOS = [
  { title: "–í–∏–Ω—Ç–∞–∂–Ω—ã–π –ø–æ—Ä—Ç—Ä–µ—Ç", short: "–ú—è–≥–∫–∏–π —Å–≤–µ—Ç, —Ç—ë–ø–ª—ã–µ —Ç–æ–Ω–∞.", caption: "–í–∏–Ω—Ç–∞–∂–Ω—ã–π –ø–æ—Ä—Ç—Ä–µ—Ç: –º—è–≥–∫–∏–π —Å–≤–µ—Ç, —Ç—ë–ø–ª—ã–µ —Ç–æ–Ω–∞. –ö–æ—Ä–æ—Ç–∫–∞—è –ø—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è: –≥–µ—Ä–æ–∏–Ω—è ‚Äî –Ω–∞—Å–ª–µ–¥–Ω–∏—Ü–∞ —Å—Ç–∞—Ä–æ–≥–æ –æ—Å–æ–±–Ω—è–∫–∞.", images:[
      "https://picsum.photos/seed/vintage1/1200/1600",
      "https://picsum.photos/seed/vintage2/1200/1600",
      "https://picsum.photos/seed/vintage3/1200/1600"
  ]},
  { title: "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≥–µ—Ä–æ–∏–Ω—è", short: "–Ø—Ä–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞ –∏ –ø–∏—Ä—Å–∏–Ω–≥.", caption: "–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å—Ç–∏–ª—å: —è—Ä–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞, –ø–∏—Ä—Å–∏–Ω–≥. –ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è: —É–ª–∏—á–Ω—ã–π –∞—Ä—Ç–∏—Å—Ç —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º.", images:[
      "https://picsum.photos/seed/alt1/1200/1600",
      "https://picsum.photos/seed/alt2/1200/1600",
      "https://picsum.photos/seed/alt3/1200/1600"
  ]},
  { title: "–ù–µ–æ–Ω–æ–≤—ã–π –∫–∏–±–µ—Ä–ø–∞–Ω–∫", short: "–ù–µ–æ–Ω, –≥–æ—Ä–æ–¥—Å–∫–æ–π –¥–æ–∂–¥—å.", caption: "–ö–∏–±–µ—Ä–ø–∞–Ω–∫: –Ω–µ–æ–Ω–æ–≤—ã–µ –∞–∫—Ü–µ–Ω—Ç—ã, –≤–ª–∞–∂–Ω—ã–π –≥–æ—Ä–æ–¥—Å–∫–æ–π –ø–µ–π–∑–∞–∂. –ö–æ—Ä–æ—Ç–∫–∞—è –ø—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è: —Ö–∞–∫–µ—Ä-–ø–æ—ç—Ç.", images:[
      "https://picsum.photos/seed/cyber1/1200/1600",
      "https://picsum.photos/seed/cyber2/1200/1600",
      "https://picsum.photos/seed/cyber3/1200/1600"
  ]},
  { title: "–ú–æ—Ä—Å–∫–æ–π –ø–æ—Ä—Ç—Ä–µ—Ç", short: "–°–≤–µ–∂–∏–π –≤–æ–∑–¥—É—Ö, –≤–µ—Ç–µ—Ä –≤ –≤–æ–ª–æ—Å–∞—Ö.", caption: "–ú–æ—Ä—Å–∫–æ–π –ø–æ—Ä—Ç—Ä–µ—Ç: –ø–∞—Å–º—É—Ä–Ω—ã–π –±–µ—Ä–µ–≥, —Å–æ–ª—ë–Ω—ã–π –≤–µ—Ç–µ—Ä, –∑–∞–¥—É–º—á–∏–≤—ã–π –≤–∑–≥–ª—è–¥.", images:[
      "https://picsum.photos/seed/sea1/1200/1600",
      "https://picsum.photos/seed/sea2/1200/1600",
      "https://picsum.photos/seed/sea3/1200/1600"
  ]},
];
/* ==================== */

const grid = document.getElementById('grid');
const mainView = document.getElementById('mainView');
const detailView = document.getElementById('detailView');
const detailImg = document.getElementById('detailImg');
const detailTitle = document.getElementById('detailTitle');
const detailCaption = document.getElementById('detailCaption');
const pager = document.getElementById('pager');
const rentBtn = document.getElementById('rentBtn');
const detailBack = document.getElementById('detailBack');

const codeArea = document.getElementById('codeArea');
const theCode = document.getElementById('theCode');
const copyBtn = document.getElementById('copyBtn');

let chosenListIndices = [];  // –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –≤ ALL_SCENARIOS
let chosenList = [];
let currentGlobalIndex = null;
let currentScenarioIndex = 0;
let slideIndex = 0;
let slideshowTimer = null;

/* Utility */
function pickRandomIndices(arrLength, n){
  const out = [];
  const idxs = Array.from({length: arrLength}, (_,i)=>i);
  while(out.length < n && idxs.length){
    const i = Math.floor(Math.random() * idxs.length);
    out.push(idxs.splice(i,1)[0]);
  }
  return out;
}

/* Render main gallery (show up to 4 random scenarios) */
function renderMain(){
  grid.innerHTML = '';
  const take = Math.min(4, ALL_SCENARIOS.length);
  chosenListIndices = pickRandomIndices(ALL_SCENARIOS.length, take);
  chosenList = chosenListIndices.map(i => ALL_SCENARIOS[i]);

  chosenList.forEach((sc, localIdx) => {
    const card = document.createElement('div');
    card.className = 'card';
    const img = document.createElement('img');
    img.className = 'thumb';
    img.src = sc.images[0];
    img.alt = sc.title;

    const overlay = document.createElement('div');
    overlay.className = 'overlay';
    overlay.innerHTML = `<div class="title">${sc.title}</div><div class="short">${sc.short}</div>
                         <div class="btn-row"><button class="btn ghost">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button></div>`;

    card.appendChild(img);
    card.appendChild(overlay);

    card.addEventListener('click', (e)=>{
      // mobile quick show overlay behavior
      if(window.innerWidth <= 900){
        if(!card.classList.contains('show-overlay')){
          card.classList.add('show-overlay');
          setTimeout(()=> card.classList.remove('show-overlay'), 3200);
          return;
        }
      }
      openDetail(localIdx);
    });

    img.addEventListener('dblclick', ()=> openDetail(localIdx));
    grid.appendChild(card);
  });
}

/* Detail open */
function openDetail(localIdx){
  currentScenarioIndex = localIdx;
  slideIndex = 0;
  currentGlobalIndex = chosenListIndices[localIdx];
  const sc = chosenList[localIdx];
  detailTitle.textContent = sc.title;
  detailCaption.textContent = sc.caption;
  detailImg.src = sc.images[slideIndex];
  renderPager(sc.images.length);
  mainView.style.display = 'none';
  detailView.classList.add('active');
  codeArea.style.display = 'none';
  startSlideshow();
  window.scrollTo({top:0, behavior:'smooth'});
}

/* Back to main */
function backToMain(){
  stopSlideshow();
  detailView.classList.remove('active');
  mainView.style.display = '';
}

/* Slideshow */
function renderPager(len){
  pager.innerHTML = '';
  for(let i=0;i<len;i++){
    const d = document.createElement('div');
    d.className = 'dot' + (i===slideIndex ? ' active' : '');
    d.addEventListener('click', ()=> {
      stopSlideshow();
      slideIndex = i;
      updateSlide();
      startSlideshow();
    });
    pager.appendChild(d);
  }
}
function updateSlide(){
  const sc = chosenList[currentScenarioIndex];
  detailImg.src = sc.images[slideIndex];
  renderPager(sc.images.length);
}
function nextSlide(){
  const sc = chosenList[currentScenarioIndex];
  slideIndex = (slideIndex + 1) % sc.images.length;
  updateSlide();
}
function prevSlide(){
  const sc = chosenList[currentScenarioIndex];
  slideIndex = (slideIndex - 1 + sc.images.length) % sc.images.length;
  updateSlide();
}
function startSlideshow(){
  stopSlideshow();
  slideshowTimer = setInterval(nextSlide, 3000); // 3 seconds
}
function stopSlideshow(){
  if(slideshowTimer){ clearInterval(slideshowTimer); slideshowTimer = null; }
}

/* Hook buttons */
detailBack.addEventListener('click', backToMain);
document.getElementById('prevBtn').addEventListener('click', ()=>{ stopSlideshow(); prevSlide(); startSlideshow(); });
document.getElementById('nextBtn').addEventListener('click', ()=>{ stopSlideshow(); nextSlide(); startSlideshow(); });

/* RENT: show code + attempt to copy */
function randSuffix(){
  const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  let s=''; for(let i=0;i<4;i++) s += chars[Math.floor(Math.random()*chars.length)];
  return s;
}
function codeForIndex(idx){
  const pad = String(idx).padStart(2,'0');
  return 'GS' + pad + randSuffix();
}

rentBtn.addEventListener('click', ()=> {
  const code = codeForIndex(currentGlobalIndex);
  theCode.textContent = code;
  codeArea.style.display = 'block';

  // try write to clipboard silently
  try{
    navigator.clipboard.writeText(code).then(()=> {
      copyBtn.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úì';
      setTimeout(()=> copyBtn.textContent = '–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å', 1500);
    }, ()=> {
      // can't write
    });
  }catch(e){}
  // For compatibility attempt Telegram.WebApp.sendData? (we intentionally DO NOT send so user copies manually)
});

copyBtn.addEventListener('click', async ()=>{
  const txt = theCode.textContent.trim();
  try{
    await navigator.clipboard.writeText(txt);
    copyBtn.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úì';
    setTimeout(()=> copyBtn.textContent = '–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å', 1500);
  }catch(e){
    alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é: ' + txt);
  }
});

/* Init Telegram WebApp hints (kept for dev transparency) */
if(window.Telegram && Telegram.WebApp){
  try{ Telegram.WebApp.expand(); }catch(e){}
  try{ Telegram.WebApp.MainButton.hide(); }catch(e){}
}

/* Init */
renderMain();
</script>
</body>
</html>
